<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>websocket 配套demo</title>
</head>
<body>
<div>

    <textarea id="text" placeholder="请输入 json 字符串" style="width: 400px;height: 300px;"></textarea>
    <input type="text" id="type" value="login" />支持：advoise|login
    <button id="switch" type="button">切换</button>
    <button id="send" type="button">发送</button>
    <script>
        var identifier = 'abcdefg';
        var token = 'cHNsABSbem0ZCqeuhu3TraEN9tQtWLWlQixgsqxKaDX0VNNRQTNkDyEnJQyWJP22UqaXHqb0D5jtWlW5iIFwftv0qQ3h8gpegF1EaSG560ei51kTxfELvNtcPbzSENjPRztAtjqNZYflNmXvxKDkUgFUGYXnk4QFA8lsVkPT7jIGUbHtLEUDsrKJWKtqYqi4ZsXdeSCYZR0tv3DxdOLT9FDhgauhl4PWlof1YV21uLPGqoUgM6cx7LsrVvCYi54';
        var uniqueCode = 'UIb6809E3505D77b06Rm3dl79yVyCaPYH3W895oU26v2qqC07I2pi36503RfE76Ttgr0ZTNXAv19l1I4r1L3PR386Ooi5429Aq4At6d1ICgV8yjsH31v82f6N53Ok65A35nvdAiO29Ru5c30443yhfrZ0iaW69IUuk088i0r04x8ufh7a572T3661sL5P0uv24wlF56Ed778SH9217qJ42G0Q98835Z6VJaAGx7Z28I83168qi8y97T45yC19qv';
        var login = `
            {
                "router": "/Login/login" ,
                "identifier": "${identifier}" ,
                "platform": "pc" ,
                "token": "" ,
                "data": {
                    "unique_code": "${uniqueCode}"
                }
            }`;
        var advoise = `
            {
                "router": "/Chat/advoise" ,
                "identifier": "abcdefg" ,
                "platform": "pc" ,
                "token": "${token}" ,
                "data": {
                    "group_id": 1 ,
                    "type": "text" ,
                    "message": "hello"
                }
            }`;
        var type=  document.querySelector('#type');
        var switchBtn = document.querySelector('#switch');
        var text = document.getElementById('text');
        var link = 'ws://192.168.61.103:9300';
        var ws = new WebSocket(link);
        ws.onopen = function () {
            console.log('websocket 已经打开');
        };

        ws.onmessage = function (e) {
          console.log('接收到来自服务器的消息：' , e.data);
        };

        ws.onclose = function (e) {
          console.log('ws 已经关闭' , e.code , e.reason);
        };

        var button = document.getElementById('send');

        button.onclick = function () {
            ws.send(text.value);
        };

        switchBtn.onclick = function(){
            var value = type.value;
            switch (value)
            {
                case 'login':
                    text.value = login;
                    break;
                case 'advoise':
                    text.value = advoise;
                    break;
                default:
                    type.value = '不支持的值';
            }
        };

    </script>
</div>
</body>
</html>